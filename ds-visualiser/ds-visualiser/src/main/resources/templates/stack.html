<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Stack Visualization</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<style>
		.stack-display {
			display: flex;
			flex-direction: column-reverse;
			align-items: center;
			margin-top: 30px;
		}

		.stack-item {
			width: 200px;
			height: 30px;
			background-color: #6c757d;
			color: white;
			display: flex;
			justify-content: center;
			align-items: center;
			border-radius: 10px;
			margin-top: 10px;
			font-weight: bold;
			font-size: 1.2em;
			position: relative;
		}

		.sp-pointer {
			position: absolute;
			right: -30px;
			color: red;
			font-weight: bold;
			font-size: 1.1em;
		}

		.stack-item.animate-push {
			animation: push 0.4s ease-out;
		}

		.stack-item.animate-pop {
			animation: pop 0.4s ease-out;
		}

		@keyframes push {
			0% {
				transform: translateY(-50px);
				opacity: 0;
			}
			100% {
				transform: translateY(0);
				opacity: 1;
			}
		}

		@keyframes pop {
			0% {
				transform: translateY(0);
				opacity: 1;
			}
			100% {
				transform: translateY(50px);
				opacity: 0;
			}
		}
	</style>
</head>

<body>
	<div class="container">
		<h2 class="text-center">Stack Visualization</h2>

		<!-- Push Form -->
		<form action="/stack/push" method="post" class="form-inline mt-4 justify-content-center">
			<input type="number" name="value" class="form-control mr-2" placeholder="Enter value" required>
			<button type="submit" class="btn btn-success">Push</button>
		</form>

		<!-- Pop Form -->
		<form action="/stack/pop" method="post" class="form-inline mt-2 justify-content-center">
			<button type="submit" class="btn btn-danger">Pop</button>
		</form>

		<!-- Message Display -->
		<div th:if="${message}" class="alert alert-info text-center mt-3">
			<p th:text="${message}"></p>
		</div>

		<!-- Stack Display with SP Pointer -->
		<div class="stack-display">
			<h4 class="text-center">Stack Elements:</h4>
			<ul class="list-unstyled">
				<li th:each="element, iterStat : ${stackElements}"
					th:class="'stack-item animate-push'"
					th:classappend="${iterStat.index == spPointer ? 'bg-primary text-white' : 'bg-light'}">
					<span th:text="${element}"></span>
					<span th:if="${iterStat.index == spPointer}" class="sp-pointer">&#x2190 SP</span>
				</li>
			</ul>

			<p th:if="${stackSize == 0}" class="text-center text-muted mt-2">
				The stack is empty. <span class="text-danger">SP â†’ Null</span>
			</p>
		</div>
	</div>

	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const pushForm = document.querySelector('form[action="/stack/push"]');
			const popForm = document.querySelector('form[action="/stack/pop"]');

			// Add animation class dynamically on push and pop
			pushForm.addEventListener("submit", () => {
				setTimeout(() => {
					document.querySelectorAll('.stack-item')[0].classList.add("animate-push");
				}, 100);
			});

			popForm.addEventListener("submit", () => {
				const stackItems = document.querySelectorAll('.stack-item');
				if (stackItems.length > 0) {
					stackItems[0].classList.add("animate-pop");
				}
			});
		});
	</script>
</body>

</html>
